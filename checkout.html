<!DOCTYPE html>
<html lang="ms">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Checkout - Nutrition Matters PJK</title>
      <link rel="stylesheet" href="css/components.css">
      <link rel="stylesheet" href="css/icons.css">
      <link rel="stylesheet" href="css/responsee.css">
      <link rel="stylesheet" href="css/template-style.css">
      <link href="https://fonts.googleapis.com/css?family=Barlow:100,300,400,700,800&subset=latin-ext" rel="stylesheet">  
      <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
      
      <style>
        body {
          background-image: url('img/belakang.jpg');
          background-size: cover;
          background-position: center;
          background-attachment: fixed;
        }
        .checkout-container {
            background: rgba(255,255,255,0.98);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            color: #000;
        }
        .page-title {
            font-size: 2rem;
            font-weight: 800;
            color: #000;
            margin-bottom: 30px;
            border-bottom: 2px solid #e53935;
            padding-bottom: 10px;
            display: inline-block;
        }
        
        /* Form Styles */
        .form-group { margin-bottom: 20px; }
        .form-label { font-weight: bold; display: block; margin-bottom: 5px; color: #333; }
        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Barlow', sans-serif;
            transition: border-color 0.3s;
        }
        .form-input:focus { border-color: #e53935; outline: none; }
        
        /* Order Summary Box */
        .order-summary-box {
            background: #f4f4f4;
            padding: 25px;
            border-radius: 15px;
            border: 1px solid #ddd;
        }
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }
        .total-line {
            border-top: 2px solid #000;
            padding-top: 15px;
            margin-top: 15px;
            font-weight: 800;
            font-size: 1.3rem;
            color: #e53935;
            display: flex;
            justify-content: space-between;
        }

        /* WhatsApp Button */
        .btn-whatsapp {
            background: #25D366; /* Warna WhatsApp */
            color: white;
            display: block;
            width: 100%;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
            transition: transform 0.2s;
            text-decoration: none;
        }
        .btn-whatsapp:hover {
            transform: translateY(-3px);
            background: #128C7E;
            color: white;
        }
      </style>
   </head>

   <body class="size-1520 primary-color-red background-dark">
      
      <header class="grid">
        <nav class="s-12 grid background-none background-primary-hightlight">
         <a href="index.html" class="m-12 l-3 padding-2x logo">
           <img src="img/Shine.png">
         </a>
         <div class="top-nav s-12 l-9">
           <button class="hamburger-menu">â˜°</button>
           <ul class="top-ul right chevron">
             <li><a href="index.html">Laman Utama</a></li>
             <li class="dropdown">
                <a href="#">Inovasi</a>
                <ul class="dropdown-menu">
                  <li><a href="onlineshop.html">Kedai Dalam Talian</a></li>
                </ul>
              </li>
              <li><a href="contact.html">Hubungi kami</a></li>
           </ul>
         </div>
        </nav>
      </header>
      
      <main role="main">
        <section class="grid margin">
            <div class="s-12 m-12 l-10 center checkout-container">
                <h1 class="page-title">Maklumat Pembayaran (Checkout)</h1>

                <div class="grid">
                    
                    <div class="s-12 l-7 margin-bottom">
                        <h3 style="margin-bottom:20px; font-weight:bold;">1. Butiran Penghantaran</h3>
                        <form id="checkoutForm">
                            <div class="form-group">
                                <label class="form-label">Nama Penuh</label>
                                <input type="text" id="custName" class="form-input" placeholder="Contoh: Ahmad bin Abu" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Nombor Telefon (WhatsApp)</label>
                                <input type="tel" id="custPhone" class="form-input" placeholder="Contoh: 0123456789" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Alamat Penghantaran Lengkap</label>
                                <textarea id="custAddress" class="form-input" rows="4" placeholder="No rumah, Jalan, Poskod, Negeri..." required></textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Nota Tambahan (Jika ada)</label>
                                <input type="text" id="custNote" class="form-input" placeholder="Contoh: Tinggalkan di pondok jaga">
                            </div>
                        </form>
                    </div>

                    <div class="s-12 l-5">
                        <div class="order-summary-box">
                            <h3 style="margin-bottom:20px; font-weight:bold;">2. Ringkasan Pesanan</h3>
                            
                            <div id="orderSummaryContent">
                                <p>Sedang memuatkan...</p>
                            </div>

                            <div class="summary-item" style="margin-top: 20px; border-top:1px dashed #ccc; padding-top:10px;">
                                <span>Kos Penghantaran</span>
                                <span>RM 8.00</span>
                            </div>

                            <div class="total-line">
                                <span>Jumlah Perlu Bayar</span>
                                <span id="finalTotalDisplay">RM 0.00</span>
                            </div>
                            
                            <p style="font-size: 0.8rem; color: #666; margin-top: 10px;">*Pembayaran akan dibuat secara manual (Online Transfer) selepas anda menghantar pesanan ini melalui WhatsApp.</p>

                            <button type="button" onclick="sendToWhatsApp()" class="btn-whatsapp">
                                <i class="fab fa-whatsapp margin-right-10"></i> Hantar Pesanan Sekarang
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </section>
      </main>
       
      <footer class="grid">
        <div class="s-12 text-center margin-bottom padding-2x background-dark">
          <p class="text-size-12 text-white">Copyright 2025, Vision Design - graphic zoo</p>
          <p class="text-size-12 text-white">Untuk Tujuan Inovasi Pendidikan Jasmani</p>
        </div>
      </footer>
      
      <script type="text/javascript" src="js/responsee.js"></script>
      <script type="text/javascript" src="js/template-scripts.js"></script>
      
      <script>
        // Global variable untuk simpan data
        var cartData = null;
        var shippingCost = 8.00;

        // 1. Load data bila page dibuka
        window.onload = function() {
            var storedData = localStorage.getItem('userCart');
            
            if (storedData) {
                cartData = JSON.parse(storedData);
                
                // Kira total
                var itemTotal = cartData.price * cartData.qty;
                var grandTotal = itemTotal + shippingCost;

                // Paparkan di bahagian ringkasan
                var summaryHTML = `
                    <div class="summary-item">
                        <span style="font-weight:bold;">${cartData.name}</span>
                    </div>
                    <div class="summary-item">
                        <span>RM ${cartData.price.toFixed(2)} x ${cartData.qty} unit</span>
                        <span style="font-weight:bold;">RM ${itemTotal.toFixed(2)}</span>
                    </div>
                `;
                
                document.getElementById('orderSummaryContent').innerHTML = summaryHTML;
                document.getElementById('finalTotalDisplay').innerText = "RM " + grandTotal.toFixed(2);

            } else {
                // Jika tiada data, balik ke kedai
                alert("Troli anda kosong. Sila pilih produk dahulu.");
                window.location.href = 'onlineshop.html';
            }
        };

        // 2. Fungsi Hantar ke WhatsApp
        function sendToWhatsApp() {
            // Ambil input dari form
            var name = document.getElementById('custName').value;
            var phone = document.getElementById('custPhone').value;
            var address = document.getElementById('custAddress').value;
            var note = document.getElementById('custNote').value;

            // Validasi mudah (Pastikan isi form)
            if (name === "" || phone === "" || address === "") {
                alert("Sila lengkapkan Nama, No Telefon dan Alamat.");
                return;
            }

            if (!cartData) return;

            // Kira harga akhir
            var itemTotal = cartData.price * cartData.qty;
            var grandTotal = itemTotal + shippingCost;

            // --- PENTING: TUKAR NOMBOR TELEFON ANDA DI SINI ---
            // Format: 601xxxxxxxx (Tanpa + atau -)
            var myPhoneNumber = "601154249470"; 

            // Bina Mesej
            var message = "*TEMPAHAN BARU (Piramid Nutriquest AR)*\n\n";
            message += "*Maklumat Pelanggan:*\n";
            message += "Nama: " + name + "\n";
            message += "No Tel: " + phone + "\n";
            message += "Alamat: " + address + "\n";
            if(note) message += "Nota: " + note + "\n";
            
            message += "\n*Butiran Pesanan:*\n";
            message += "Item: " + cartData.name + "\n";
            message += "Kuantiti: " + cartData.qty + "\n";
            message += "Harga Item: RM " + itemTotal.toFixed(2) + "\n";
            message += "Penghantaran: RM " + shippingCost.toFixed(2) + "\n";
            message += "-----------------------------\n";
            message += "*JUMLAH BESAR: RM " + grandTotal.toFixed(2) + "*\n\n";
            message += "Sila tunggu, mesej ini akan dibalas. Terima kasih.";

            // Encode mesej untuk URL
            var encodedMessage = encodeURIComponent(message);

            // Buka WhatsApp
            var whatsappUrl = "https://wa.me/" + myPhoneNumber + "?text=" + encodedMessage;
            window.open(whatsappUrl, '_blank');
        }
      </script>

   </body>
</html>