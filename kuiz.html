<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nutrition Matters PJK - Kuiz</title>
    
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/icons.css">
    <link rel="stylesheet" href="css/responsee.css">
    <link rel="stylesheet" href="css/template-style.css">
    <link rel="stylesheet" href="owl-carousel/owl.carousel.css">
    <link rel="stylesheet" href="owl-carousel/owl.theme.css">
    
    <link href="https://fonts.googleapis.com/css?family=Barlow:100,300,400,700,800&amp;subset=latin-ext" rel="stylesheet">   
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="js/hamburger.js"></script>
    <script src="js/quiz-leaderboard.js"></script> 

    <style>
        body {
            background-image: url('img/belakang.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        main {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        /* --- Enhanced Quiz Container (Glassmorphism) --- */
        .quiz-container {
            width: 100%;
            max-width: 700px;
            background: rgba(20, 20, 20, 0.85); /* Darker background */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
            color: white;
            position: relative;
            overflow: hidden;
        }

        /* Top decorative line */
        .quiz-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #ff9900, #ff5500);
        }

        /* Form Styling */
        .form-control {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-bottom: 2px solid #666;
            border-radius: 5px;
            color: white;
            padding: 15px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .form-control:focus {
            background: rgba(255, 255, 255, 0.2);
            border-bottom-color: #ff9900;
            box-shadow: none;
            color: white;
        }

        .form-label {
            font-weight: 700;
            letter-spacing: 1px;
            color: #ffcc80;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        /* Image Styling */
        .question-img {
            width: 100%;
            max-height: 300px;
            object-fit: contain;
            margin: 20px 0;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border: 2px solid #444;
        }

        /* Buttons Styling */
        .btn-option {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 15px;
            text-align: left;
            font-size: 1.1rem;
            border-radius: 10px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .btn-option:hover {
            background-color: rgba(255, 165, 0, 0.2);
            border-color: #ff9900;
            transform: translateX(5px);
            color: #fff;
        }

        .btn-start {
            background: linear-gradient(45deg, #ff9900, #ff5500);
            border: none;
            font-weight: 800;
            letter-spacing: 1px;
            padding: 15px;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(255, 85, 0, 0.4);
            transition: transform 0.2s;
        }

        .btn-start:hover {
            transform: scale(1.02);
            color: white;
        }

        /* Progress Bar */
        .progress {
            height: 10px;
            background-color: #333;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .progress-bar {
            background: linear-gradient(90deg, #ff9900, #ff5500);
        }

        /* Leaderboard */
        .leaderboard {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            border: 1px dashed #555;
        }
        .list-group-item {
            border-bottom: 1px solid rgba(255,255,255,0.1) !important;
        }

        /* Correct/Wrong State overrides for JS */
        .btn-success { background-color: #28a745 !important; border-color: #28a745 !important; }
        .btn-danger { background-color: #dc3545 !important; border-color: #dc3545 !important; }

        h3#question-text {
            font-weight: 700;
            line-height: 1.4;
            margin-bottom: 20px;
        }
    </style>
</head>

<body class="size-1520 primary-color-red background-dark">

    <header class="grid">
        <nav class="s-12 grid background-none background-primary-hightlight">
            <a href="index.html" class="m-12 l-3 padding-2x logo">
                <img src="img/Shine.png" alt="Logo">
            </a>
            <div class="top-nav s-12 l-9">
                <button class="hamburger-menu">â˜°</button>
                <ul class="top-ul right chevron">
                    <li><a href="index.html">Laman Utama</a></li>
                    <li class="dropdown">
                        <a href="#">Sumber pemakanan</a>
                        <ul class="dropdown-menu">
                            <li><a href="Notapemakanan.html">Pemakanan Makronutrien & Mikronutrien</a></li>
                            <li><a href="https://cookpad.com/my/search/sihat">Resepi Makanan Sihat</a></li>
                            <li><a href="https://www.youtube.com/watch?v=WqD2xv-4S9g">Pinggan Sihat Malaysia</a></li>
                            <li><a href="https://www2.moh.gov.my/index.php/pages/view/2725">Piramid Makanan Malaysia</a></li>
                            <li><a href="https://www.calculator.net/calorie-calculator.html">Kalkulator Kalori</a></li>
                            <li><a href="cadangan latihan.html">Cadangan Latihan</a></li>
                            <li><a href="kuiz.html">Kuiz Pemakanan</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#">Inovasi</a>
                        <ul class="dropdown-menu">
                            <li><a href="inovasi.html">Inovasi Karnival Pengajian Pendidikan 2025</a></li>
                            <li><a href="eduinnovate.html">Edu Innovate 2025</a></li>
                            <li><a href="sportsinnochal.html">USM-AUSC International Sports Innovation Challenge 2025</a></li>
                            <li><a href="feedback.html">Maklum Balas</a></li>
                            <li><a href="onlineshop.html">Kedai Dalam Talian</a></li>
                        </ul>
                    </li>
                    <li><a href="maklumatguru.html">Maklumat Guru</a></li>
                    <li><a href="contact.html">Hubungi kami</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <div class="quiz-container animate__animated animate__fadeIn">
            
            <div class="text-center mb-4">
                <h1 class="text-uppercase fw-bold" style="color: #fff;">Kuiz Pemakanan</h1>
                <p class="text-white-50">Uji minda anda & kumpul markah!</p>
            </div>

            <div id="quiz-form">
                <form id="student-info-form">
                    <div class="mb-4">
                        <label for="name" class="form-label"><i class="fas fa-user me-2"></i>Nama Penuh</label>
                        <input type="text" class="form-control" id="name" placeholder="Masukkan nama anda..." required>
                    </div>
                    <div class="mb-4">
                        <label for="class" class="form-label"><i class="fas fa-school me-2"></i>Kelas</label>
                        <input type="text" class="form-control" id="class" placeholder="Masukkan kelas anda..." required>
                    </div>
                    <button type="submit" class="btn btn-start w-100 rounded-pill">MULA KUIZ <i class="fas fa-rocket ms-2"></i></button>
                </form>
            </div>

            <div id="quiz-section" style="display:none;">
                <div class="d-flex justify-content-between text-white-50 small mb-1">
                    <span id="progress-text">Soalan 1</span>
                    <span>Masa: Tiada Had</span>
                </div>
                <div class="progress">
                    <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                </div>

                <div id="question-container" class="animate__animated animate__fadeIn">
                    <h3 id="question-text" class="text-center"></h3>
                    <img id="question-image" class="question-img" src="" alt="Question Image" style="display:none;">
                    
                    <div id="answer-buttons" class="d-grid gap-2 mt-4">
                        </div>
                </div>
                
                <button id="next-btn" class="btn btn-light mt-4 w-100 fw-bold" style="display:none;">
                    Soalan Seterusnya <i class="fas fa-arrow-right ms-1"></i>
                </button>
            </div>

            <audio id="correct-sound" src="sounds/right.mp3" preload="auto"></audio>
            <audio id="wrong-sound" src="sounds/wrong.mp3" preload="auto"></audio>
            <audio id="bg-music" src="sounds/Lobby Music (Original Soundtrack).mp3" preload="auto" loop></audio>

            <div id="leaderboard-section" class="leaderboard mt-4" style="display:none;">
                <div class="text-center mb-3">
                    <i class="fas fa-trophy fa-3x text-warning mb-2 animate__animated animate__bounceIn"></i>
                    <h4>Keputusan Terkini</h4>
                </div>
                
                <ul id="leaderboard-list" class="list-group list-group-flush"></ul>
                
                <div class="d-grid gap-2 mt-4">
                    <button onclick="location.reload()" class="btn btn-secondary">
                        <i class="fas fa-redo me-2"></i>Jawab Semula
                    </button>
                    <button onclick="resetLeaderboard()" class="btn btn-outline-danger btn-sm">
                        Reset Rekod
                    </button>
                </div>
            </div>

        </div>
    </main>

    <footer class="grid">
        <div class="s-12 l-3 m-row-3 margin-bottom background-image" style="background-image:url(img/fakulti.jpg)"></div>
        <div class="s-12 m-9 l-3 padding-2x margin-bottom background-dark">
           <h2 class="text-strong text-uppercase">Siapa kami?</h2>
           <p>Kami adalah pelajar semester 5 dalam bidang Pendidikan Jasmani di bawah Fakulti Sains Sukan dan Kejurulatihan.</p>
        </div>
        <div class="s-12 text-center margin-bottom">
           <p class="text-size-12 text-white">Copyright 2025, Nutrition Matters PJK</p>
        </div>
    </footer>

    <script type="text/javascript" src="js/responsee.js"></script>
    <script type="text/javascript" src="owl-carousel/owl.carousel.js"></script>
    <script type="text/javascript" src="js/template-scripts.js"></script>

    <script>
        // --- SAMPLE DATA FOR TESTING (If external JS fails) ---
        // Note: If js/quiz-leaderboard.js exists and has 'const questions', this block is ignored.
        if (typeof questions === 'undefined') {
            var questions = [
                {
                    text: "Apakah makronutrien utama untuk tenaga?",
                    answers: [
                        { text: "Karbohidrat", correct: true },
                        { text: "Protein", correct: false },
                        { text: "Lemak", correct: false },
                        { text: "Vitamin", correct: false }
                    ]
                },
                {
                    text: "Berapakah hidangan buah-buahan yang disarankan sehari?",
                    answers: [
                        { text: "1 sajian", correct: false },
                        { text: "2 sajian", correct: true },
                        { text: "5 sajian", correct: false },
                        { text: "Tiada had", correct: false }
                    ]
                }
            ];
        }

        let currentQuestionIndex = 0;
        let score = 0;
        const studentData = {};

        const form = document.getElementById('student-info-form');
        const quizSection = document.getElementById('quiz-section');
        const questionText = document.getElementById('question-text');
        const questionImage = document.getElementById('question-image');
        const answerButtons = document.getElementById('answer-buttons');
        const nextButton = document.getElementById('next-btn');
        const leaderboardSection = document.getElementById('leaderboard-section');
        const leaderboardList = document.getElementById('leaderboard-list');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');

        // Start Quiz
        form.addEventListener('submit', e => {
            e.preventDefault();
            studentData.name = document.getElementById('name').value;
            studentData.class = document.getElementById('class').value;
            
            // Play Music (Browser requires interaction first)
            document.getElementById('bg-music').volume = 0.3;
            document.getElementById('bg-music').play().catch(e => console.log("Audio autoplay blocked"));

            document.getElementById('quiz-form').style.display = 'none';
            quizSection.style.display = 'block';
            startQuiz();
        });

        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            nextButton.innerText = "Soalan Seterusnya";
            showQuestion();
        }

        function showQuestion() {
            resetState();
            let question = questions[currentQuestionIndex];
            let qNo = currentQuestionIndex + 1;
            
            // Update Progress
            let progressPercent = ((currentQuestionIndex) / questions.length) * 100;
            progressBar.style.width = progressPercent + "%";
            progressText.innerText = "Soalan " + qNo + " dari " + questions.length;

            // Show Text
            questionText.innerText = question.text;

            // Show Image if exists
            if (question.image) {
                questionImage.src = question.image;
                questionImage.style.display = 'block';
            } else {
                questionImage.style.display = 'none';
            }

            // Create Buttons
            question.answers.forEach(answer => {
                const btn = document.createElement('button');
                btn.innerText = answer.text;
                btn.classList.add('btn', 'btn-option', 'w-100');
                if(answer.correct) {
                    btn.dataset.correct = answer.correct;
                }
                btn.addEventListener('click', selectAnswer);
                answerButtons.appendChild(btn);
            });
        }

        function resetState() {
            nextButton.style.display = 'none';
            while (answerButtons.firstChild) {
                answerButtons.removeChild(answerButtons.firstChild);
            }
        }

        function selectAnswer(e) {
            const selectedBtn = e.target;
            const isCorrect = selectedBtn.dataset.correct === "true";
            
            if (isCorrect) {
                selectedBtn.classList.add('btn-success');
                score++;
                document.getElementById('correct-sound').play();
            } else {
                selectedBtn.classList.add('btn-danger');
                document.getElementById('wrong-sound').play();
            }

            // Show correct answer automatically
            Array.from(answerButtons.children).forEach(button => {
                if (button.dataset.correct === "true") {
                    button.classList.add('btn-success');
                }
                button.disabled = true; // Disable clicking again
            });

            nextButton.style.display = 'block';
        }

        nextButton.addEventListener('click', () => {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                progressBar.style.width = "100%";
                showScore();
            }
        });

        function showScore() {
            resetState();
            questionText.innerHTML = `
                <div class='animate__animated animate__zoomIn'>
                    <span class='display-1'>${score} / ${questions.length}</span><br>
                    <span class='h4'>Tahniah ${studentData.name}!</span>
                </div>`;
            
            nextButton.style.display = "none";
            quizSection.style.display = "none"; // Hide quiz area
            leaderboardSection.style.display = "block"; // Show leaderboard
            
            saveAndShowLeaderboard();
        }

        function saveAndShowLeaderboard() {
            const li = document.createElement('li');
            li.className = 'list-group-item bg-transparent text-white d-flex justify-content-between align-items-center';
            li.innerHTML = `
                <div>
                    <i class="fas fa-user-graduate me-2"></i>
                    <strong>${studentData.name}</strong> <small class="text-muted">(${studentData.class})</small>
                </div>
                <span class="badge bg-warning text-dark rounded-pill">${score} mata</span>
            `;
            leaderboardList.appendChild(li);
            // Note: Real persistence needs localStorage or a Database. 
            // This just shows the current session.
        }

        function resetLeaderboard() {
            leaderboardList.innerHTML = "";
        }
    </script>
</body>
</html>
